<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trello Board Viewer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: space-around;
            align-items: flex-start;
            height: 100vh;
            margin: 0;
        }

        .list {
            width: 200px;
            padding: 10px;
            background-color: #f4f4f4;
            border-radius: 5px;
        }

        .card {
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin-bottom: 10px;
            padding: 5px;
            cursor: grab;
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>
        // Replace with your Trello API key and token
        
const apiKey = '7d14288264ab0bf23e34850a66e9528e';
       const token = 'ATTAc4e9eee205f99466cbe7b9e67bdc03db64e48cb1723aabc8ad5bdb9cecbbffc5D4FB9F69';
const boardId = '58e8964f1c3d23a2f251e15a';

        async function fetchTrelloData() {
            try {
                const response = await fetch(`https://api.trello.com/1/boards/${boardId}?key=${apiKey}&token=${token}&cards=all&lists=all`);
                const data = await response.json();
                return data;
            } catch (error) {
                console.error('Error fetching Trello data:', error);
                return null;
            }
        }

        function renderBoard(boardData) {
            const app = document.getElementById('app');

            if (!boardData || !boardData.lists) {
                console.error('Invalid Trello board data:', boardData);
                return;
            }

            boardData.lists.forEach(list => {
                // Skip closed (archived) lists
                if (list.closed) {
                    console.log(`List ${list.name} is closed. Skipping...`);
                    return;
                }

                const listContainer = document.createElement('div');
                listContainer.className = 'list';
                listContainer.setAttribute('id', list.id);

                if (list.cards && list.cards.length > 0) {
                    list.cards.forEach(card => {
                        const cardElement = document.createElement('div');
                        cardElement.className = 'card';
                        cardElement.textContent = card.name;

                        // Make the card draggable
                        cardElement.draggable = true;

                        // Add touch events for iOS
                        cardElement.addEventListener('touchstart', touchStart);
                        cardElement.addEventListener('touchmove', touchMove);
                        cardElement.addEventListener('touchend', touchEnd);

                        listContainer.appendChild(cardElement);
                    });
                } else {
                    console.warn(`List ${list.name} has no cards.`);
                }

                app.appendChild(listContainer);
            });

            // Enable drag-and-drop functionality
            enableDragAndDrop();
        }

        function enableDragAndDrop() {
            const cards = document.querySelectorAll('.card');

            cards.forEach(card => {
                card.addEventListener('dragstart', (event) => {
                    event.dataTransfer.setData('text/plain', card.parentElement.id);
                });

                card.addEventListener('dragover', (event) => {
                    event.preventDefault();
                });

                card.addEventListener('drop', (event) => {
                    event.preventDefault();
                    const sourceListId = event.dataTransfer.getData('text/plain');
                    const targetListId = card.parentElement.id;

                    // Handle the logic to update Trello board here
                    console.log(`Move card from list ${sourceListId} to list ${targetListId}`);
                });
            });
        }

        // Touch events for iOS
        let touchId = null;

        function touchStart(event) {
            touchId = event.targetTouches[0].identifier;
        }

        function touchMove(event) {
            if (touchId !== null) {
                event.preventDefault();
                const touch = Array.from(event.changedTouches).find(t => t.identifier === touchId);
                if (touch) {
                    // Your drag logic here
                    // You may need to calculate the movement and update the card position accordingly
                }
            }
        }

        function touchEnd(event) {
            if (touchId !== null) {
                touchId = null;
            }
        }

        async function init() {
            try {
                const boardData = await fetchTrelloData();
                if (boardData) {
                    renderBoard(boardData);
                }
            } catch (error) {
                console.error('Error initializing Trello board:', error);
            }
        }

        init();
    </script>
</body>
</html>